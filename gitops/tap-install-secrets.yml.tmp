#@ load("@ytt:yaml", "yaml")
---
#@ def config():
tap:
  credentials:
  
    tanzuNet:
      username: TANZUNET_USERNAME
      password: TANZUNET_PASSWORD

    registry:
      username: REGISTRY_USERNAME
      password: REGISTRY_PASSWORD
    
    github:
      username: GITHUB_USERNAME
      clientId: GITHUB_APP_CLIENT_ID
      clientSecret: GITHUB_APP_CLIENT_SECRET
      token: GITHUB_ACCESSTOKEN

    catalogs:
      - type: url
        target: https://github.com/ynamadi/tanzu-java-web-app/blob/main/catalog/catalog-info.yaml
        
    metadataStore:
      accessToken: "Bearer METADATA_ACCESS_TOKEN"
        
    #! Remove suffix "-disabled" to enable Backstage persistence.
    backstage-disabled:
      database:
        client: pg
        host: INSERT-DB-HOST
        port: 5432
        username: INSERT-DB-USERNAME
        password: INSERT-DB-PASSWORD
#@ end
---
apiVersion: v1
kind: Secret
metadata:
  name: tap-install-gitops-github
  namespace: tap-install-gitops
stringData:
  username: github
  password: GITHUB_ACCESSTOKEN
---
apiVersion: v1
kind: Secret
metadata:
  name: tap-install-gitops
  namespace: tap-install-gitops
stringData:
  tap-secrets.yml: #@ yaml.encode(config())
